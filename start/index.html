<!DOCTYPE html>
<title>Dungee</title>
<meta charset="UTF-8"/>
<nav>
    <a href="/">Home</a>
    <a href="start">Start new Dungee</a>
    <a href="play">Play existing Dungee</a>
</nav>

<h1>Create new Dungee</h1>

<button onclick="generarandom()">CREATE DUNGEE</button>
<p id="pinEl"></p>
<p id="playersEl"></p>
<button onclick="mostrarPreguntas()">JUGAR YA!</button>
<p id="preguntasEl"></p>

<script>
    let pin;
    function generarandom(){
        pin = Math.floor(Math.random()*9000)+1000;
        pinEl.innerText = pin;
        playersEl.innerText = "";

        setInterval(obtenerUsuarios, 3000);
    }

    function obtenerUsuarios(){
        fetch(`https://dungee-tin.vercel.app/api/damelosusers?pin=${pin}`)
        .then(string => string.json())
        .then(json => {
            playersEl.innerText  = "";

            for (const x in json.users) {
                playersEl.innerText += json.users[x].name;
            }
        })
    }

    function mostrarPreguntas(){
        fetch("https://dungee-tin.vercel.app/api/damelasquestions")
        .then(data =>  data.json())
        .then(questions => {
            for (const pregunta in questions.preguntas){

                preguntasEl.innerHTML += "<h1>" + questions.preguntas[pregunta].pregunta + "</h1>";
                preguntasEl.innerHTML += "<h2>" + questions.preguntas[pregunta].respuesta0 + "</h2>";
                preguntasEl.innerHTML += "<h2>" + questions.preguntas[pregunta].respuesta1 + "</h2>";
                preguntasEl.innerHTML += "<h2>" + questions.preguntas[pregunta].respuesta2 + "</h2>";
                preguntasEl.innerHTML += "<h2>" + questions.preguntas[pregunta].respuesta3 + "</h2>";


            }
        })
    }

</script>
